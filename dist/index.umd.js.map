{"version":3,"file":"index.umd.js","sources":["../src/index.js"],"sourcesContent":["import { useLayoutEffect, useState, useRef } from 'react'\n\nconst defaultSize = [0, 0]\n\nlet resizeObserver\nconst callbacks = {}\n\n/**\n * Returns current width and height of specified element.\n *\n * @param {Ref} ref element to use in size calculation\n */\nconst useElementSize = ref => {\n  const [size, setSize] = useState(defaultSize)\n  // generate id based on current number of callbacks\n  const elId = useRef(`resize-${Object.keys(callbacks).length + 1}`)\n\n  const updateSizes = entries => {\n    window.requestAnimationFrame(() => {\n      entries.forEach(entry => {\n        const target = entry.target.current || entry.target\n        callbacks[target.getAttribute('resize-id')](entry)\n      })\n    })\n  }\n\n  // all instances use the same observer\n  resizeObserver = resizeObserver || new ResizeObserver(updateSizes)\n\n  useLayoutEffect(() => {\n    if (!ref?.current) return\n\n    ref.current.setAttribute('resize-id', elId.current)\n\n    // set initial size\n    setSize([\n      ref?.current?.getBoundingClientRect().width,\n      ref?.current?.getBoundingClientRect().height,\n    ])\n\n    // add callback for this instance\n    callbacks[elId.current] = entry => {\n      if (!entry) return\n\n      if (entry.contentBoxSize?.[0]) {\n        setSize([entry.contentBoxSize[0].inlineSize, entry.contentBoxSize[0].blockSize])\n      } else if (entries?.contentBoxSize) {\n        setSize([entry.contentBoxSize.inlineSize, entry.contentBoxSize[0].blockSize])\n      } else {\n        setSize([entry.contentRect.width, entry.contentRect.height])\n      }\n    }\n\n    // watch for size changes\n    resizeObserver.observe(ref?.current)\n\n    // eslint-disable-next-line consistent-return\n    return () => {\n      if (!ref?.current) return\n\n      resizeObserver.unobserve(ref?.current)\n    }\n  }, [ref?.current])\n\n  return size\n}\n\nexport default useElementSize\n"],"names":["resizeObserver","defaultSize","callbacks","ref","useState","size","setSize","elId","useRef","Object","keys","length","ResizeObserver","entries","window","requestAnimationFrame","forEach","entry","target","current","getAttribute","useLayoutEffect","setAttribute","_ref$current","getBoundingClientRect","width","_ref$current2","height","contentBoxSize","_entry$contentBoxSize","inlineSize","blockSize","_entries","contentRect","observe","unobserve"],"mappings":"mQAEA,IAEIA,EAFEC,EAAc,CAAC,EAAG,GAGlBC,EAAY,UAOK,SAAAC,GACrB,MAAwBC,WAASH,GAA1BI,OAAMC,OAEPC,EAAOC,oBAAiBC,OAAOC,KAAKR,GAAWS,OAAS,IAiD9D,OArCAX,EAAiBA,GAAkB,IAAIY,eAVnB,SAAAC,GAClBC,OAAOC,sBAAsB,WAC3BF,EAAQG,QAAQ,SAAAC,GAEdf,GADee,EAAMC,OAAOC,SAAWF,EAAMC,QAC5BE,aAAa,cAAcH,SAQlDI,kBAAgB,mBACd,GAAKlB,MAAAA,GAAAA,EAAKgB,QA2BV,OAzBAhB,EAAIgB,QAAQG,aAAa,YAAaf,EAAKY,SAG3Cb,EAAQ,CACNH,MAAAA,aAAAA,EAAKgB,4BAALI,EAAcC,wBAAwBC,MACtCtB,MAAAA,aAAAA,EAAKgB,4BAALO,EAAcF,wBAAwBG,SAIxCzB,EAAUK,EAAKY,SAAW,SAAAF,WACnBA,cAEDA,EAAMW,6BAANC,EAAuB,GACzBvB,EAAQ,CAACW,EAAMW,eAAe,GAAGE,WAAYb,EAAMW,eAAe,GAAGG,sBAC5DlB,sBAAAmB,EAASJ,eAClBtB,EAAQ,CAACW,EAAMW,eAAeE,WAAYb,EAAMW,eAAe,GAAGG,YAElEzB,EAAQ,CAACW,EAAMgB,YAAYR,MAAOR,EAAMgB,YAAYN,WAKxD3B,EAAekC,QAAQ/B,MAAAA,SAAAA,EAAKgB,oBAIrBhB,MAAAA,GAAAA,EAAKgB,SAEVnB,EAAemC,UAAUhC,MAAAA,SAAAA,EAAKgB,WAE/B,CAAChB,MAAAA,SAAAA,EAAKgB,UAEFd"}